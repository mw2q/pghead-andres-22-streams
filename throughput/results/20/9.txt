BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%maroon%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 266669819.279251
 ALGERIA                   |   1997 | 448895501.134604
 ALGERIA                   |   1996 | 451718065.017162
 ALGERIA                   |   1995 | 458513161.708631
 ALGERIA                   |   1994 | 454063272.989176
 ALGERIA                   |   1993 | 451512644.047012
 ALGERIA                   |   1992 | 454416541.250069
 ARGENTINA                 |   1998 |  273525639.93607
 ARGENTINA                 |   1997 | 460945282.608975
 ARGENTINA                 |   1996 | 468220248.945903
 ARGENTINA                 |   1995 |   462155816.7044
 ARGENTINA                 |   1994 | 461863043.467087
 ARGENTINA                 |   1993 | 462404780.282156
 ARGENTINA                 |   1992 | 465723006.225678
 BRAZIL                    |   1998 | 277232609.375374
 BRAZIL                    |   1997 | 464836589.101865
 BRAZIL                    |   1996 |   458244910.3007
 BRAZIL                    |   1995 | 470302969.649971
 BRAZIL                    |   1994 | 471112651.642608
 BRAZIL                    |   1993 | 469259234.000375
 BRAZIL                    |   1992 | 466638305.204534
 CANADA                    |   1998 | 279807878.808133
 CANADA                    |   1997 | 472099199.977419
 CANADA                    |   1996 | 483930614.647246
 CANADA                    |   1995 | 474510485.883475
 CANADA                    |   1994 | 482394395.325188
 CANADA                    |   1993 |  469534804.28326
 CANADA                    |   1992 | 484780599.463659
 CHINA                     |   1998 | 275597503.992481
 CHINA                     |   1997 | 467843633.308172
 CHINA                     |   1996 | 464926308.391283
 CHINA                     |   1995 | 462353519.619754
 CHINA                     |   1994 | 467444961.578786
 CHINA                     |   1993 | 472046311.371596
 CHINA                     |   1992 | 469966257.183711
 EGYPT                     |   1998 | 274565012.711864
 EGYPT                     |   1997 | 459813500.889234
 EGYPT                     |   1996 | 460369925.580771
 EGYPT                     |   1995 | 463466646.682932
 EGYPT                     |   1994 | 461519724.194037
 EGYPT                     |   1993 | 460140428.364669
 EGYPT                     |   1992 | 463685385.448127
 ETHIOPIA                  |   1998 |  269708355.45085
 ETHIOPIA                  |   1997 | 449453039.184186
 ETHIOPIA                  |   1996 | 456949720.383733
 ETHIOPIA                  |   1995 | 456855445.149931
 ETHIOPIA                  |   1994 | 462896620.937432
 ETHIOPIA                  |   1993 | 459615029.258576
 ETHIOPIA                  |   1992 |  460373329.51616
 FRANCE                    |   1998 | 268181057.948699
 FRANCE                    |   1997 |  459754341.90799
 FRANCE                    |   1996 | 456371877.311294
 FRANCE                    |   1995 | 456523864.339371
 FRANCE                    |   1994 | 456405217.915225
 FRANCE                    |   1993 | 460284365.068256
 FRANCE                    |   1992 | 461462712.900668
 GERMANY                   |   1998 | 281994286.999926
 GERMANY                   |   1997 | 478388197.204727
 GERMANY                   |   1996 | 473530017.372885
 GERMANY                   |   1995 | 476367506.828568
 GERMANY                   |   1994 | 487659407.090233
 GERMANY                   |   1993 | 479984820.353342
 GERMANY                   |   1992 | 486050130.152009
 INDIA                     |   1998 | 278544694.796792
 INDIA                     |   1997 | 476918378.144423
 INDIA                     |   1996 |   484015486.7377
 INDIA                     |   1995 | 483142903.285587
 INDIA                     |   1994 | 471910184.783049
 INDIA                     |   1993 | 478422336.734525
 INDIA                     |   1992 | 486937018.467918
 INDONESIA                 |   1998 |  272127199.69971
 INDONESIA                 |   1997 | 462404323.622172
 INDONESIA                 |   1996 | 465233187.194758
 INDONESIA                 |   1995 |  460205105.32798
 INDONESIA                 |   1994 | 461424995.986723
 INDONESIA                 |   1993 | 463124035.816129
 INDONESIA                 |   1992 | 473233619.159702
 IRAN                      |   1998 | 272821186.413678
 IRAN                      |   1997 | 451584808.478693
 IRAN                      |   1996 | 459166509.973184
 IRAN                      |   1995 | 460754314.610332
 IRAN                      |   1994 | 463495547.510575
 IRAN                      |   1993 | 456823355.293067
 IRAN                      |   1992 | 462122177.030862
 IRAQ                      |   1998 | 276991522.745911
 IRAQ                      |   1997 | 468719023.338749
 IRAQ                      |   1996 | 470954969.906741
 IRAQ                      |   1995 | 466660258.641737
 IRAQ                      |   1994 | 476425878.184059
 IRAQ                      |   1993 | 477608990.704411
 IRAQ                      |   1992 | 477268897.134459
 JAPAN                     |   1998 | 272835843.920412
 JAPAN                     |   1997 | 466542210.891182
 JAPAN                     |   1996 | 469941317.642908
 JAPAN                     |   1995 | 465512785.034586
 JAPAN                     |   1994 | 462843774.248871
 JAPAN                     |   1993 | 461530740.204589
 JAPAN                     |   1992 | 459537778.297525
 JORDAN                    |   1998 |  265546010.21201
 JORDAN                    |   1997 | 459237486.541659
 JORDAN                    |   1996 | 462445101.548608
 JORDAN                    |   1995 | 460085585.564174
 JORDAN                    |   1994 | 457798455.088809
 JORDAN                    |   1993 | 467736797.674653
 JORDAN                    |   1992 | 457392327.084572
 KENYA                     |   1998 | 277628717.259398
 KENYA                     |   1997 | 470648366.507347
 KENYA                     |   1996 | 472777706.686016
 KENYA                     |   1995 | 468619572.438947
 KENYA                     |   1994 | 468618632.882246
 KENYA                     |   1993 | 469565208.238146
 KENYA                     |   1992 | 472239357.798851
 MOROCCO                   |   1998 | 262801008.488183
 MOROCCO                   |   1997 | 463169987.576523
 MOROCCO                   |   1996 | 470314691.764966
 MOROCCO                   |   1995 | 461097150.239739
 MOROCCO                   |   1994 |  463513639.39022
 MOROCCO                   |   1993 | 463038437.987651
 MOROCCO                   |   1992 | 465860562.795043
 MOZAMBIQUE                |   1998 | 268557647.290244
 MOZAMBIQUE                |   1997 |  462749393.48735
 MOZAMBIQUE                |   1996 | 468268962.676827
 MOZAMBIQUE                |   1995 | 468763640.422752
 MOZAMBIQUE                |   1994 | 465646342.681255
 MOZAMBIQUE                |   1993 |  464303118.93986
 MOZAMBIQUE                |   1992 |  463024220.63736
 PERU                      |   1998 | 269988758.939579
 PERU                      |   1997 | 466923618.226592
 PERU                      |   1996 | 458753499.652533
 PERU                      |   1995 | 459047702.394297
 PERU                      |   1994 | 457187281.626627
 PERU                      |   1993 | 465414615.357144
 PERU                      |   1992 | 458165105.172801
 ROMANIA                   |   1998 |  271741785.31246
 ROMANIA                   |   1997 | 477386630.437711
 ROMANIA                   |   1996 | 475237894.614016
 ROMANIA                   |   1995 | 462466688.259604
 ROMANIA                   |   1994 | 466594742.859904
 ROMANIA                   |   1993 | 465636050.650825
 ROMANIA                   |   1992 | 465888221.115119
 RUSSIA                    |   1998 | 276393557.146745
 RUSSIA                    |   1997 | 473251557.099002
 RUSSIA                    |   1996 | 471820787.793338
 RUSSIA                    |   1995 | 469361221.412718
 RUSSIA                    |   1994 | 471261142.009601
 RUSSIA                    |   1993 | 465170487.420711
 RUSSIA                    |   1992 | 469612939.891539
 SAUDI ARABIA              |   1998 | 275756832.995083
 SAUDI ARABIA              |   1997 | 461744827.777576
 SAUDI ARABIA              |   1996 | 476547158.607864
 SAUDI ARABIA              |   1995 | 474038567.334157
 SAUDI ARABIA              |   1994 | 468910342.797613
 SAUDI ARABIA              |   1993 |  466170810.25795
 SAUDI ARABIA              |   1992 | 470197216.918714
 UNITED KINGDOM            |   1998 | 270984401.724435
 UNITED KINGDOM            |   1997 | 465550477.301674
 UNITED KINGDOM            |   1996 |  469031824.84766
 UNITED KINGDOM            |   1995 | 461350594.209367
 UNITED KINGDOM            |   1994 |  465657918.31238
 UNITED KINGDOM            |   1993 | 464659283.161754
 UNITED KINGDOM            |   1992 | 471623711.149455
 UNITED STATES             |   1998 | 273115218.335828
 UNITED STATES             |   1997 | 475471507.033887
 UNITED STATES             |   1996 |  467015898.81237
 UNITED STATES             |   1995 | 462867077.579893
 UNITED STATES             |   1994 | 469098750.885798
 UNITED STATES             |   1993 |  468762896.53277
 UNITED STATES             |   1992 | 464658567.781387
 VIETNAM                   |   1998 | 277657221.803669
 VIETNAM                   |   1997 | 462078158.307807
 VIETNAM                   |   1996 |  477721071.28365
 VIETNAM                   |   1995 | 473885669.485536
 VIETNAM                   |   1994 | 467003178.323926
 VIETNAM                   |   1993 | 464961561.164219
 VIETNAM                   |   1992 | 474948140.179747
(175 rows)

COMMIT;
COMMIT
