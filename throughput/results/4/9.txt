BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%mint%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264443110.463257
 ALGERIA                   |   1997 | 456759931.824445
 ALGERIA                   |   1996 | 462185698.042373
 ALGERIA                   |   1995 | 465626616.294235
 ALGERIA                   |   1994 | 454299832.432107
 ALGERIA                   |   1993 | 460735858.020768
 ALGERIA                   |   1992 | 457922606.991195
 ARGENTINA                 |   1998 | 271817653.951314
 ARGENTINA                 |   1997 | 467353238.731589
 ARGENTINA                 |   1996 | 472693193.396274
 ARGENTINA                 |   1995 | 471246355.979748
 ARGENTINA                 |   1994 | 466534368.005326
 ARGENTINA                 |   1993 | 462577958.930528
 ARGENTINA                 |   1992 | 465939323.986842
 BRAZIL                    |   1998 | 275704890.979986
 BRAZIL                    |   1997 | 474080583.050851
 BRAZIL                    |   1996 | 471861447.391098
 BRAZIL                    |   1995 |  471340682.05823
 BRAZIL                    |   1994 | 468899454.005362
 BRAZIL                    |   1993 | 473734672.171686
 BRAZIL                    |   1992 | 466883691.183566
 CANADA                    |   1998 | 273579184.024025
 CANADA                    |   1997 | 477626203.306175
 CANADA                    |   1996 | 479926456.688435
 CANADA                    |   1995 | 473614719.429316
 CANADA                    |   1994 | 476900123.214772
 CANADA                    |   1993 | 476008588.261259
 CANADA                    |   1992 | 475917833.449301
 CHINA                     |   1998 | 270081340.279399
 CHINA                     |   1997 | 466410001.961009
 CHINA                     |   1996 | 460036904.344623
 CHINA                     |   1995 | 461736187.050434
 CHINA                     |   1994 | 462875932.772199
 CHINA                     |   1993 | 461774943.204607
 CHINA                     |   1992 | 465106789.358998
 EGYPT                     |   1998 | 271090065.155405
 EGYPT                     |   1997 | 459207351.999084
 EGYPT                     |   1996 | 461897501.321387
 EGYPT                     |   1995 | 455856968.559372
 EGYPT                     |   1994 | 456492606.384237
 EGYPT                     |   1993 |  470674929.51799
 EGYPT                     |   1992 | 460140258.067104
 ETHIOPIA                  |   1998 | 268594761.631199
 ETHIOPIA                  |   1997 | 444939903.228968
 ETHIOPIA                  |   1996 | 457544053.105651
 ETHIOPIA                  |   1995 |  462304338.18245
 ETHIOPIA                  |   1994 | 463536766.386098
 ETHIOPIA                  |   1993 | 450281380.667871
 ETHIOPIA                  |   1992 | 458872152.202228
 FRANCE                    |   1998 | 265652910.576016
 FRANCE                    |   1997 | 462770569.825464
 FRANCE                    |   1996 | 462334947.380794
 FRANCE                    |   1995 | 461490081.255661
 FRANCE                    |   1994 | 469678217.505383
 FRANCE                    |   1993 | 461909136.907437
 FRANCE                    |   1992 | 466468796.683143
 GERMANY                   |   1998 | 277272740.886735
 GERMANY                   |   1997 |  482005409.18829
 GERMANY                   |   1996 | 482080637.877822
 GERMANY                   |   1995 | 473818879.917614
 GERMANY                   |   1994 | 472001278.593202
 GERMANY                   |   1993 |  473247036.91633
 GERMANY                   |   1992 | 476278222.069406
 INDIA                     |   1998 | 279414379.462432
 INDIA                     |   1997 | 473010002.177078
 INDIA                     |   1996 |  475782873.92042
 INDIA                     |   1995 | 475111034.725767
 INDIA                     |   1994 | 474971668.045294
 INDIA                     |   1993 | 472121100.944809
 INDIA                     |   1992 | 483609766.591026
 INDONESIA                 |   1998 | 271068147.913647
 INDONESIA                 |   1997 | 458644303.550323
 INDONESIA                 |   1996 |  468969481.49141
 INDONESIA                 |   1995 | 452811142.145158
 INDONESIA                 |   1994 | 459057005.217714
 INDONESIA                 |   1993 | 458637076.665229
 INDONESIA                 |   1992 | 459142505.994007
 IRAN                      |   1998 | 266510806.689304
 IRAN                      |   1997 | 456492587.985232
 IRAN                      |   1996 | 461946309.886971
 IRAN                      |   1995 | 453042227.883864
 IRAN                      |   1994 | 457109978.692317
 IRAN                      |   1993 | 460162299.030112
 IRAN                      |   1992 |  461362186.09023
 IRAQ                      |   1998 |  272449834.70131
 IRAQ                      |   1997 | 465400830.424321
 IRAQ                      |   1996 | 469419723.282599
 IRAQ                      |   1995 | 465370830.626113
 IRAQ                      |   1994 |  475482247.65741
 IRAQ                      |   1993 | 466456584.717052
 IRAQ                      |   1992 | 466820693.067106
 JAPAN                     |   1998 | 270723563.688327
 JAPAN                     |   1997 | 460295940.257329
 JAPAN                     |   1996 | 460106946.392916
 JAPAN                     |   1995 |  467114012.32777
 JAPAN                     |   1994 | 460029066.926259
 JAPAN                     |   1993 | 463497261.835469
 JAPAN                     |   1992 |  464944550.49098
 JORDAN                    |   1998 | 273792773.257189
 JORDAN                    |   1997 | 456424296.096177
 JORDAN                    |   1996 | 460201405.924417
 JORDAN                    |   1995 | 460175327.211343
 JORDAN                    |   1994 | 460095695.556651
 JORDAN                    |   1993 | 458053427.488161
 JORDAN                    |   1992 | 450910686.295434
 KENYA                     |   1998 | 280171051.254783
 KENYA                     |   1997 | 474014220.448781
 KENYA                     |   1996 | 482046231.517244
 KENYA                     |   1995 | 469211185.053818
 KENYA                     |   1994 | 484555558.482609
 KENYA                     |   1993 | 470143349.187744
 KENYA                     |   1992 | 473105470.767118
 MOROCCO                   |   1998 | 270270599.678981
 MOROCCO                   |   1997 | 446548328.031599
 MOROCCO                   |   1996 | 457397548.356215
 MOROCCO                   |   1995 | 469013631.618149
 MOROCCO                   |   1994 | 459024550.334094
 MOROCCO                   |   1993 | 455905122.057228
 MOROCCO                   |   1992 | 462852717.205596
 MOZAMBIQUE                |   1998 | 274166569.264556
 MOZAMBIQUE                |   1997 | 458861797.247587
 MOZAMBIQUE                |   1996 | 468449830.628753
 MOZAMBIQUE                |   1995 | 463740529.742904
 MOZAMBIQUE                |   1994 | 465677347.094166
 MOZAMBIQUE                |   1993 |  471008300.43788
 MOZAMBIQUE                |   1992 | 463207592.067866
 PERU                      |   1998 | 273153901.971543
 PERU                      |   1997 | 473615276.233269
 PERU                      |   1996 | 469345282.442882
 PERU                      |   1995 | 467450939.694805
 PERU                      |   1994 |  471582921.78033
 PERU                      |   1993 | 463966385.086546
 PERU                      |   1992 | 466815623.912817
 ROMANIA                   |   1998 | 276838656.525591
 ROMANIA                   |   1997 | 465609557.954814
 ROMANIA                   |   1996 | 471561874.338737
 ROMANIA                   |   1995 | 469378015.505791
 ROMANIA                   |   1994 | 468420453.484392
 ROMANIA                   |   1993 | 475239671.284504
 ROMANIA                   |   1992 | 470175097.630919
 RUSSIA                    |   1998 | 273680654.891009
 RUSSIA                    |   1997 | 460941220.017724
 RUSSIA                    |   1996 | 471565879.265872
 RUSSIA                    |   1995 | 460783845.574402
 RUSSIA                    |   1994 | 461106362.374805
 RUSSIA                    |   1993 | 469694351.847079
 RUSSIA                    |   1992 | 460158703.858159
 SAUDI ARABIA              |   1998 | 270257623.586821
 SAUDI ARABIA              |   1997 | 475457288.337372
 SAUDI ARABIA              |   1996 | 465748565.619291
 SAUDI ARABIA              |   1995 | 470512310.446167
 SAUDI ARABIA              |   1994 | 467244715.611525
 SAUDI ARABIA              |   1993 | 473680902.137798
 SAUDI ARABIA              |   1992 | 474384062.383004
 UNITED KINGDOM            |   1998 | 265757446.311023
 UNITED KINGDOM            |   1997 | 460933885.964299
 UNITED KINGDOM            |   1996 | 448904512.074404
 UNITED KINGDOM            |   1995 | 457907249.723416
 UNITED KINGDOM            |   1994 | 453401399.513867
 UNITED KINGDOM            |   1993 | 455692567.628522
 UNITED KINGDOM            |   1992 | 456629773.104567
 UNITED STATES             |   1998 |  283781612.44278
 UNITED STATES             |   1997 | 481405942.902373
 UNITED STATES             |   1996 | 474858141.138342
 UNITED STATES             |   1995 | 472882413.881459
 UNITED STATES             |   1994 | 482599226.899819
 UNITED STATES             |   1993 | 476584532.784794
 UNITED STATES             |   1992 | 471864685.022081
 VIETNAM                   |   1998 | 278572792.205725
 VIETNAM                   |   1997 | 464307926.871281
 VIETNAM                   |   1996 | 466028440.007747
 VIETNAM                   |   1995 | 466801914.171992
 VIETNAM                   |   1994 |    470363998.263
 VIETNAM                   |   1993 | 466684338.137187
 VIETNAM                   |   1992 | 468914044.693497
(175 rows)

COMMIT;
COMMIT
