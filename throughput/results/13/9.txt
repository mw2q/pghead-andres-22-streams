BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%white%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 273393706.843176
 ALGERIA                   |   1997 |  458420778.71831
 ALGERIA                   |   1996 | 460795497.398025
 ALGERIA                   |   1995 | 463074817.140115
 ALGERIA                   |   1994 |  455758900.75142
 ALGERIA                   |   1993 | 465075509.738339
 ALGERIA                   |   1992 | 471875747.695194
 ARGENTINA                 |   1998 | 265590940.417401
 ARGENTINA                 |   1997 | 463921681.732288
 ARGENTINA                 |   1996 |  464771339.04928
 ARGENTINA                 |   1995 | 464134574.877701
 ARGENTINA                 |   1994 | 461093257.826453
 ARGENTINA                 |   1993 | 459077217.226819
 ARGENTINA                 |   1992 | 459882506.347816
 BRAZIL                    |   1998 | 274817699.800095
 BRAZIL                    |   1997 |  470360841.51369
 BRAZIL                    |   1996 | 461752127.490661
 BRAZIL                    |   1995 | 469857078.272101
 BRAZIL                    |   1994 | 467155415.707024
 BRAZIL                    |   1993 | 465306157.950123
 BRAZIL                    |   1992 | 466846473.909159
 CANADA                    |   1998 | 273750575.264796
 CANADA                    |   1997 | 477650527.316759
 CANADA                    |   1996 | 482109814.856678
 CANADA                    |   1995 | 474578887.173669
 CANADA                    |   1994 |   483967550.1124
 CANADA                    |   1993 | 483208652.243159
 CANADA                    |   1992 | 484853929.687312
 CHINA                     |   1998 | 272328041.095486
 CHINA                     |   1997 | 465853505.618769
 CHINA                     |   1996 | 463961533.733779
 CHINA                     |   1995 | 470019641.845543
 CHINA                     |   1994 | 472428253.249502
 CHINA                     |   1993 | 465961272.803861
 CHINA                     |   1992 | 476227556.029091
 EGYPT                     |   1998 | 266478868.464431
 EGYPT                     |   1997 | 460473571.290126
 EGYPT                     |   1996 |  459917171.22823
 EGYPT                     |   1995 | 457782930.068564
 EGYPT                     |   1994 | 454370463.411395
 EGYPT                     |   1993 | 467040640.434482
 EGYPT                     |   1992 | 461082456.024437
 ETHIOPIA                  |   1998 | 266996969.821608
 ETHIOPIA                  |   1997 | 460581647.451594
 ETHIOPIA                  |   1996 | 463503436.064709
 ETHIOPIA                  |   1995 | 469605924.172419
 ETHIOPIA                  |   1994 | 467585107.646787
 ETHIOPIA                  |   1993 | 465682024.032839
 ETHIOPIA                  |   1992 | 463934201.123813
 FRANCE                    |   1998 | 270930886.265144
 FRANCE                    |   1997 | 468924619.644542
 FRANCE                    |   1996 | 466896621.755742
 FRANCE                    |   1995 | 473698713.808212
 FRANCE                    |   1994 | 465667244.020317
 FRANCE                    |   1993 | 463541243.688207
 FRANCE                    |   1992 | 464966686.999237
 GERMANY                   |   1998 | 279232487.771342
 GERMANY                   |   1997 | 482511480.438308
 GERMANY                   |   1996 | 477137835.657761
 GERMANY                   |   1995 | 480944537.318531
 GERMANY                   |   1994 | 473481112.283973
 GERMANY                   |   1993 |   474485374.5305
 GERMANY                   |   1992 | 473596651.104102
 INDIA                     |   1998 | 280938806.604615
 INDIA                     |   1997 | 477301633.567345
 INDIA                     |   1996 |  481130554.22739
 INDIA                     |   1995 | 475177633.561916
 INDIA                     |   1994 | 484211490.260254
 INDIA                     |   1993 | 472809265.523376
 INDIA                     |   1992 | 485942592.572382
 INDONESIA                 |   1998 | 272357185.554991
 INDONESIA                 |   1997 | 474950713.296222
 INDONESIA                 |   1996 | 468254636.892176
 INDONESIA                 |   1995 | 462080517.188354
 INDONESIA                 |   1994 | 469635678.245481
 INDONESIA                 |   1993 | 463580622.307723
 INDONESIA                 |   1992 |  463644542.46674
 IRAN                      |   1998 | 273036854.848186
 IRAN                      |   1997 | 468601390.905561
 IRAN                      |   1996 | 463086847.313399
 IRAN                      |   1995 | 471553599.844247
 IRAN                      |   1994 | 470145796.240017
 IRAN                      |   1993 |   465007505.4968
 IRAN                      |   1992 | 466787511.016532
 IRAQ                      |   1998 | 278371913.726641
 IRAQ                      |   1997 | 480377831.820315
 IRAQ                      |   1996 | 476381935.256524
 IRAQ                      |   1995 | 475211820.127156
 IRAQ                      |   1994 | 482427259.118812
 IRAQ                      |   1993 |  479496953.40228
 IRAQ                      |   1992 | 476920623.435428
 JAPAN                     |   1998 | 275177743.186026
 JAPAN                     |   1997 | 465394089.268754
 JAPAN                     |   1996 | 472754635.102212
 JAPAN                     |   1995 | 471699847.864199
 JAPAN                     |   1994 | 465557975.499964
 JAPAN                     |   1993 | 470568181.369055
 JAPAN                     |   1992 | 463970854.398823
 JORDAN                    |   1998 | 268510682.028504
 JORDAN                    |   1997 | 465300067.092441
 JORDAN                    |   1996 | 457651580.451501
 JORDAN                    |   1995 | 462288609.787866
 JORDAN                    |   1994 | 461922377.171106
 JORDAN                    |   1993 | 456411657.348686
 JORDAN                    |   1992 | 464223026.022331
 KENYA                     |   1998 | 271818776.655913
 KENYA                     |   1997 | 467050471.370099
 KENYA                     |   1996 | 467301512.287787
 KENYA                     |   1995 | 461292693.281999
 KENYA                     |   1994 | 466509797.572797
 KENYA                     |   1993 | 465493479.554071
 KENYA                     |   1992 | 466376077.670339
 MOROCCO                   |   1998 | 271912264.243316
 MOROCCO                   |   1997 | 468134736.129681
 MOROCCO                   |   1996 | 472840388.276646
 MOROCCO                   |   1995 | 466176001.450832
 MOROCCO                   |   1994 | 464777873.008102
 MOROCCO                   |   1993 | 464945442.272601
 MOROCCO                   |   1992 |  464000885.41601
 MOZAMBIQUE                |   1998 | 269878678.058514
 MOZAMBIQUE                |   1997 | 460146456.136035
 MOZAMBIQUE                |   1996 | 461833090.110423
 MOZAMBIQUE                |   1995 | 463460517.453812
 MOZAMBIQUE                |   1994 | 457447323.591538
 MOZAMBIQUE                |   1993 | 460504540.257659
 MOZAMBIQUE                |   1992 | 461337007.113033
 PERU                      |   1998 | 272455578.498401
 PERU                      |   1997 | 464592287.856521
 PERU                      |   1996 |  458557872.59891
 PERU                      |   1995 | 460566417.248611
 PERU                      |   1994 | 460769585.902602
 PERU                      |   1993 |  462254537.08337
 PERU                      |   1992 | 471070925.340802
 ROMANIA                   |   1998 |  282767920.53809
 ROMANIA                   |   1997 | 480586261.256674
 ROMANIA                   |   1996 | 475102163.782948
 ROMANIA                   |   1995 | 480599282.316752
 ROMANIA                   |   1994 | 483113994.447398
 ROMANIA                   |   1993 | 481292800.924106
 ROMANIA                   |   1992 |   472177778.1283
 RUSSIA                    |   1998 | 273584835.710084
 RUSSIA                    |   1997 | 468385176.572312
 RUSSIA                    |   1996 | 471179433.908119
 RUSSIA                    |   1995 | 476910425.636725
 RUSSIA                    |   1994 | 467638304.577857
 RUSSIA                    |   1993 |  471888677.34702
 RUSSIA                    |   1992 | 471756608.626398
 SAUDI ARABIA              |   1998 |  275001608.76841
 SAUDI ARABIA              |   1997 |   472940089.8266
 SAUDI ARABIA              |   1996 | 462417887.731835
 SAUDI ARABIA              |   1995 | 471114470.464765
 SAUDI ARABIA              |   1994 |  468762484.24306
 SAUDI ARABIA              |   1993 | 468301908.218861
 SAUDI ARABIA              |   1992 | 482928272.690397
 UNITED KINGDOM            |   1998 | 274130354.102578
 UNITED KINGDOM            |   1997 | 470728497.589751
 UNITED KINGDOM            |   1996 | 468820758.051385
 UNITED KINGDOM            |   1995 | 458877610.775701
 UNITED KINGDOM            |   1994 | 463235336.977679
 UNITED KINGDOM            |   1993 | 465709991.034501
 UNITED KINGDOM            |   1992 | 469523154.679504
 UNITED STATES             |   1998 | 276763851.359902
 UNITED STATES             |   1997 | 474164740.590878
 UNITED STATES             |   1996 | 474208061.034376
 UNITED STATES             |   1995 | 470266891.268918
 UNITED STATES             |   1994 | 473527094.875776
 UNITED STATES             |   1993 | 462707230.361779
 UNITED STATES             |   1992 |  459246181.13468
 VIETNAM                   |   1998 | 270484480.237284
 VIETNAM                   |   1997 | 465107275.599447
 VIETNAM                   |   1996 | 473094907.191328
 VIETNAM                   |   1995 | 479365962.459055
 VIETNAM                   |   1994 | 470068611.089894
 VIETNAM                   |   1993 | 473162274.708345
 VIETNAM                   |   1992 | 472078746.919178
(175 rows)

COMMIT;
COMMIT
